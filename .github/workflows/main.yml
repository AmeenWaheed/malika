name: Start Windows VPS with NoMachine Only

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
    - name: Download NoMachine
      run: |
        Invoke-WebRequest -Uri "https://download.nomachine.com/download/8.11/Windows/nomachine_8.11.3_1_x64.exe" -OutFile "nx.exe"
        Start-Process -FilePath ".\nx.exe" -ArgumentList "/S" -Wait

    - name: Show IP Address and Credentials
      run: |
        $ip = (Invoke-WebRequest -Uri "http://ipinfo.io/ip").Content.Trim()
        $user = $env:USERNAME
        Write-Host "ğŸ”‘ NoMachine Access Info:"
        Write-Host "ğŸŒ IP Address: $ip"
        Write-Host "ğŸ‘¤ Username: $user"
        Write-Host "ğŸ”’ Password: Not set - You may need to set it manually"
